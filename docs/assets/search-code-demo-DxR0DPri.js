import{d as j,r as i,e as z,c as d,o as c,a as s,i as R,w as f,v as B,j as D,t as y,g as H,k as L,b as F,u as v,F as K,f as W,n as q}from"./index-BQWKhZBY.js";import{_ as E}from"./code-viewer.vue_vue_type_script_setup_true_lang-B6ZiQW4p.js";import{S as O}from"./index-Dtb1mRhT.js";import{L as A}from"./index-CI7Qy5JG.js";import{C as G}from"./index-B_9fpI7Z.js";import{s as J}from"./syntax-highlight-code-DgCuU-5Z.js";/* empty css               */const Q={class:"p-4"},X={class:"mb-4"},Y={class:"bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4"},Z={class:"flex flex-wrap items-center gap-3 mb-4"},ee={class:"flex-grow"},te={class:"flex items-center"},se=["disabled"],le={class:"flex flex-wrap gap-4 mb-4"},ae={class:"flex items-center text-sm text-gray-700"},oe={class:"flex items-center text-sm text-gray-700"},ne={class:"flex items-center text-sm text-gray-700"},re={key:0,class:"flex items-center justify-between"},ie={class:"text-sm text-gray-700"},ue={class:"flex gap-2"},de=["disabled"],ce=["disabled"],ge={class:"h-96 border border-gray-200"},ve={key:0,class:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200 text-xs text-gray-600"},me={class:"max-h-40 overflow-y-auto"},pe=["onClick"],he={class:"flex items-center"},xe={class:"font-medium mr-2"},be={class:"mr-2 text-blue-600 text-xs"},fe=["innerHTML"],Ve=j({__name:"search-code-demo",setup(ye){const S=J.split(`
`).map((t,e)=>({id:`line-${e+1}`,content:t})),r=i(null),u=i(""),_=i(!1),k=i(!1),w=i(!1),M=i(void 0),l=i([]),o=i(-1),m=i(!1),T=z(()=>l.value.length===0?"无匹配结果":`找到 ${l.value.length} 个结果${o.value>=0?`，当前第 ${o.value+1} 个`:""}`),V=()=>{if(!u.value.trim()||!r.value){l.value=[],o.value=-1,g();return}m.value=!0;try{g();const t={keyword:u.value,useRegex:_.value,caseSensitive:k.value,wholeWord:w.value,maxResults:M.value};l.value=r.value.search(t),o.value=l.value.length>0?0:-1,o.value>=0&&p(o.value)}catch(t){console.error("搜索出错:",t),l.value=[],o.value=-1,g()}finally{m.value=!1}},p=t=>{if(t>=0&&t<l.value.length&&r.value){const e=l.value[t];g(),P(e),r.value.scrollToLine(e.line.index),o.value=t}},$=()=>{if(l.value.length===0)return;const t=(o.value+1)%l.value.length;p(t)},N=()=>{if(l.value.length===0)return;const t=o.value<=0?l.value.length-1:o.value-1;p(t)},I=()=>{u.value="",g(),l.value=[],o.value=-1},g=()=>{if(!r.value)return;const t=l.value.map(e=>({id:e.line.id,meta:{columnHighlights:[]}}));t.length>0&&r.value.updateLinesMeta(t)},P=t=>{if(!r.value)return;const e=t.matches.map(([a,n])=>({startColumn:a,endColumn:n,style:{backgroundColor:"rgba(255, 215, 0, 0.3)",borderRadius:"2px",zIndex:1}}));r.value.updateLinesMeta([{id:t.line.id,meta:{columnHighlights:e}}])},U=(t,e)=>{if(!e||e.length===0)return t;const a=[...e].sort((x,b)=>x[0]-b[0]);let n="",h=0;for(const[x,b]of a)n+=C(t.substring(h,x)),n+=`<span class="bg-yellow-200 text-black px-0.5 rounded">${C(t.substring(x,b))}</span>`,h=b;return n+=C(t.substring(h)),n},C=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return(t,e)=>(c(),d("div",Q,[s("div",X,[e[7]||(e[7]=s("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"搜索代码关键字",-1)),e[8]||(e[8]=s("p",{class:"text-sm text-gray-600 mb-4"},"这个示例展示了如何使用搜索功能查找代码中的关键字，并跳转到匹配行。",-1)),s("div",Y,[s("div",Z,[s("div",ee,[s("div",te,[f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),type:"text",placeholder:"输入搜索关键字",class:"w-full px-3 py-2 border border-gray-300 rounded text-sm",onKeyup:D(V,["enter"])},null,544),[[B,u.value]]),s("button",{onClick:V,class:"ml-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm transition-colors",disabled:m.value||!u.value.trim()},y(m.value?"搜索中...":"搜索"),9,se),l.value.length>0?(c(),d("button",{key:0,onClick:I,class:"ml-2 px-3 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded text-sm transition-colors"}," 清除 ")):R("",!0)])])]),s("div",le,[s("label",ae,[f(s("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=a=>_.value=a),class:"mr-1"},null,512),[[L,_.value]]),e[4]||(e[4]=H(" 使用正则表达式 "))]),s("label",oe,[f(s("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=a=>k.value=a),class:"mr-1"},null,512),[[L,k.value]]),e[5]||(e[5]=H(" 区分大小写 "))]),s("label",ne,[f(s("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>w.value=a),class:"mr-1"},null,512),[[L,w.value]]),e[6]||(e[6]=H(" 全字匹配 "))])]),l.value.length>0?(c(),d("div",re,[s("div",ie,y(T.value),1),s("div",ue,[s("button",{onClick:N,class:"px-3 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded text-sm transition-colors",disabled:l.value.length<=1}," 上一个 ",8,de),s("button",{onClick:$,class:"px-3 py-1 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded text-sm transition-colors",disabled:l.value.length<=1}," 下一个 ",8,ce)])])):R("",!0)])]),s("div",ge,[F(v(E),{ref_key:"codeViewerRef",ref:r,code:v(S),plugins:[v(O),v(A),v(G)],language:"javascript",size:"medium"},null,8,["code","plugins"])]),l.value.length>0?(c(),d("div",ve,[e[9]||(e[9]=s("h4",{class:"font-medium mb-2"},"搜索结果详情:",-1)),s("div",me,[(c(!0),d(K,null,W(l.value,(a,n)=>(c(),d("div",{key:n,class:q(["py-1 px-2 mb-1 rounded cursor-pointer hover:bg-gray-200",{"bg-blue-100":n===o.value}]),onClick:h=>p(n)},[s("div",he,[s("span",xe,"行 "+y(a.line.index)+":",1),s("span",be," ["+y(a.matches.length>1?`${a.matches.length}个匹配`:"1个匹配")+"] ",1),s("span",{innerHTML:U(a.line.content,a.matches)},null,8,fe)])],10,pe))),128))])])):R("",!0)]))}});export{Ve as default};
