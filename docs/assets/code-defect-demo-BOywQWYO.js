import{_ as r}from"./code-viewer.vue_vue_type_script_setup_true_lang-B6ZiQW4p.js";import{L as a}from"./index-BwyJd34J.js";import{S as n}from"./index-Dtb1mRhT.js";import{L as d}from"./index-CI7Qy5JG.js";import{C as i}from"./index-B_9fpI7Z.js";import{d as c,h as t,c as m,o as u,a as e,b as g,u as x}from"./index-BQWKhZBY.js";/* empty css               */const b={class:"p-4"},p={class:"h-[600px] border border-gray-200 rounded-lg overflow-hidden"},E=c({__name:"code-defect-demo",setup(f){const l=[{id:"1",content:"// 代码缺陷检测示例",meta:{}},{id:"2",content:"function processUserData(userData) {",meta:{}},{id:"3",content:"  // 未对输入进行验证",meta:{}},{id:"4",content:"  const userId = userData.id;",meta:{bgColor:"rgba(255, 235, 230, 0.3)",columnHighlights:[{startColumn:17,endColumn:28,style:{backgroundColor:"rgba(255, 0, 0, 0.2)"}}],boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-red-50 border-l-4 border-red-500 rounded ml-12"},[t("div",{class:"font-bold text-red-700"},"潜在的空引用错误"),t("div",{class:"text-sm text-red-600"},"未检查 userData 是否为 null 或 undefined 就访问其属性"),t("div",{class:"text-xs text-gray-600 mt-1"},"建议: 添加空值检查，例如 userData?.id 或 userData && userData.id")]),boxHeightMultiplier:4}},{id:"5",content:"  ",meta:{}},{id:"6",content:"  // SQL 注入风险",meta:{}},{id:"7",content:"  const query = 'SELECT * FROM users WHERE id = ' + userId;",meta:{bgColor:"rgba(255, 245, 210, 0.4)",columnHighlights:[{startColumn:52,endColumn:58,style:{backgroundColor:"rgba(255, 180, 0, 0.3)"}}],boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-yellow-50 border-l-4 border-yellow-500 rounded ml-12"},[t("div",{class:"font-bold text-yellow-800"},"SQL 注入漏洞"),t("div",{class:"text-sm text-yellow-700"},"直接拼接用户输入到 SQL 查询中可能导致 SQL 注入攻击"),t("div",{class:"text-xs text-gray-600 mt-1"},"建议: 使用参数化查询或预处理语句")]),boxHeightMultiplier:4}},{id:"8",content:"  ",meta:{}},{id:"9",content:"  // 内存泄漏风险",meta:{}},{id:"10",content:"  let resources = acquireExpensiveResources();",meta:{}},{id:"11",content:"  processResources(resources);",meta:{}},{id:"12",content:"  // 缺少资源释放",meta:{bgColor:"rgba(230, 240, 255, 0.4)",boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-blue-50 border-l-4 border-blue-500 rounded ml-12"},[t("div",{class:"font-bold text-blue-700"},"潜在的内存泄漏"),t("div",{class:"text-sm text-blue-600"},"获取的资源未在函数结束前释放"),t("div",{class:"text-xs text-gray-600 mt-1"},"建议: 添加 try-finally 块确保资源释放，或使用自动资源管理")]),boxHeightMultiplier:4}},{id:"13",content:"  ",meta:{}},{id:"14",content:"  // 不安全的密码处理",meta:{}},{id:"15",content:"  if (userData.password === 'admin123') {",meta:{bgColor:"rgba(255, 220, 220, 0.4)",columnHighlights:[{startColumn:6,endColumn:37,style:{backgroundColor:"rgba(255, 0, 0, 0.2)"}}],boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-red-50 border-l-4 border-red-500 rounded ml-12"},[t("div",{class:"font-bold text-red-700"},"安全风险: 硬编码凭证"),t("div",{class:"text-sm text-red-600"},"代码中包含硬编码的密码，且使用了不安全的明文比较"),t("div",{class:"text-xs text-gray-600 mt-1"},"建议: 使用安全的密码哈希比较，避免硬编码凭证")]),boxHeightMultiplier:4}},{id:"16",content:'    console.log("Admin access granted");',meta:{}},{id:"17",content:"  }",meta:{}},{id:"18",content:"  ",meta:{}},{id:"19",content:"  // 未使用的变量",meta:{}},{id:"20",content:"  const userEmail = userData.email;",meta:{columnHighlights:[{startColumn:8,endColumn:17,style:{backgroundColor:"rgba(180, 180, 180, 0.3)"}}],boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-gray-50 border-l-4 border-gray-400 rounded ml-12"},[t("div",{class:"font-bold text-gray-700"},"代码质量问题: 未使用的变量"),t("div",{class:"text-sm text-gray-600"},"变量 userEmail 被声明但从未使用"),t("div",{class:"text-xs text-gray-500 mt-1"},"建议: 移除未使用的变量或将其用于预期目的")]),boxHeightMultiplier:4}},{id:"21",content:"  ",meta:{}},{id:"22",content:"  return { success: true };",meta:{}},{id:"23",content:"}",meta:{}},{id:"24",content:"",meta:{}},{id:"25",content:"// 调用示例",meta:{}},{id:"26",content:"processUserData({ id: 123 });",meta:{}},{id:"27",content:"processUserData(null); // 将导致运行时错误",meta:{bgColor:"rgba(255, 235, 230, 0.3)",columnHighlights:[{startColumn:16,endColumn:20,style:{backgroundColor:"rgba(255, 0, 0, 0.2)"}}],boxContent:t("div",{class:"flex flex-col gap-1 p-2 bg-red-50 border-l-4 border-red-500 rounded ml-12"},[t("div",{class:"font-bold text-red-700"},"运行时错误"),t("div",{class:"text-sm text-red-600"},"传入 null 将导致第4行出现空引用异常"),t("div",{class:"text-xs text-gray-600 mt-1"},"建议: 在函数开始处添加参数验证")]),boxHeightMultiplier:4}}],s=[i,n,d,a];return(C,o)=>(u(),m("div",b,[o[0]||(o[0]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"代码缺陷检测示例"),e("p",{class:"text-sm text-gray-600"}," 这个示例展示了如何使用 Code Viewer 组件来可视化展示代码中的潜在缺陷和安全问题。通过组合使用列高亮、行背景色和可变高度盒子等功能，可以直观地标记和解释代码中的问题。 ")],-1)),e("div",p,[g(x(r),{code:l,plugins:s,language:"javascript",size:"medium"})]),o[1]||(o[1]=e("div",{class:"mt-4 p-3 bg-gray-50 rounded-lg border border-gray-200 text-xs text-gray-600"},[e("p",{class:"font-medium mb-1"},"示例说明："),e("ul",{class:"list-disc pl-5 space-y-1"},[e("li",null,"红色标记 - 严重安全问题或可能导致崩溃的错误"),e("li",null,"黄色标记 - 中等风险问题，如潜在的安全漏洞"),e("li",null,"蓝色标记 - 资源管理问题，如内存泄漏"),e("li",null,"灰色标记 - 代码质量问题，如未使用的变量")])],-1))]))}});export{E as default};
